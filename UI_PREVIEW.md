# 界面美化预览

## 🎨 新界面设计

### 完整对话流程示例

```
============================================================
              AI编程助手 - Function Calling版本
============================================================

[系统环境]
  - 操作系统  : windows
  - Shell    : powershell
  - Python   : python3 [✓]
  - Git      : 可用 [✓]

[功能特性]
  - 查询操作（read, list）  : 自动执行
  - 修改操作（edit, rename）: 先执行后确认，可撤销
  - 危险操作（run, commit） : 提前批准，不可撤销

------------------------------------------------------------

[i] 已加载 5 条历史消息


────────────────────────────────────────────────────────────

[U] 你: 帮我读取README.md文件

[A] AI: 好的，我来为你读取README.md文件。

  ┌────────────────────────────────────────────────────────┐
  │ 工具调用: read_file                                      │
  │ / 执行中...

[✓] 完成
  │ ────────────────────────────────────────────────────────
  │ [文件] 内容:
  │ ```
  │ # AI编程助手
  │ 
  │ 这是一个AI编程助手...
  │ ```
  └────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────

[U] 你: 在main.go中搜索ProcessManager

[A] AI: 我来搜索ProcessManager。

  ┌────────────────────────────────────────────────────────┐
  │ 工具调用: search_code                                    │
  │ | 执行中...

[✓] 完成
  │ ────────────────────────────────────────────────────────
  │ [搜索] 结果:
  │ ```
  │ main.go:15:    processManager := process.NewManager()
  │ main.go:28:    toolExecutor := tools.NewExecutor(processManager, backupManager)
  │ ```
  └────────────────────────────────────────────────────────┘


────────────────────────────────────────────────────────────

[U] 你: 运行测试命令

[A] AI: 我需要你批准执行命令。

[!] 警告：以下操作不可撤销，需要立即批准：
1. run_command({"command": "go test", "interactive": false})

批准方式:
  y       - 全部同意
  n       - 全部拒绝
  y 1,2,3 - 只同意指定的（白名单）
  n 1,3   - 拒绝指定的（黑名单）

请选择: y

  ┌────────────────────────────────────────────────────────┐
  │ 工具调用: run_command                                    │
  │ - 执行中...

[✓] 完成
  │ ────────────────────────────────────────────────────────
  │ [✓] 进程已启动
  │ 进程ID: proc_001
  │ 命令: go test
  └────────────────────────────────────────────────────────┘

```

## 📐 设计特点

### 1. **清晰的轮次分隔**
每轮对话前都有一条分隔线：
```
────────────────────────────────────────────────────────────
```
- 使用灰色（colorMuted）
- 60个字符宽
- 让不同轮次一目了然

### 2. **用户输入区域**
```
[U] 你: 你的输入在这里
```
- `[U]` 绿色加粗
- "你:" 绿色加粗
- 前面有分隔线

### 3. **AI回复区域**
```
[A] AI: AI的回复在这里
```
- `[A]` 青色加粗
- "AI:" 青色加粗
- 回复内容正常显示

### 4. **工具调用框**
美观的框线结构：
```
  ┌────────────────────────────────────────────────────────┐
  │ 工具调用: tool_name                                      │
  │ / 执行中...
```
- 顶部框线（灰色）
- 工具名称（洋红色）
- Spinner动画（`-\|/` 循环）
- 左侧缩进2个空格

### 5. **工具结果显示**
```
[✓] 完成
  │ ────────────────────────────────────────────────────────
  │ 结果内容在这里
  │ 可以有多行
  └────────────────────────────────────────────────────────┘
```
- 状态标记：`[✓]` 成功（绿色）/ `[✗]` 失败（红色）
- "完成" 或 "失败" 文字（灰色）
- 中间分隔线
- 结果内容每行前加 `│` 边框
- 底部闭合框线
- 所有内容缩进显示

### 6. **错误显示**
```
[✗] 失败
  │ ────────────────────────────────────────────────────────
  │ [✗] 错误信息在这里
  └────────────────────────────────────────────────────────┘
```
- 错误消息用红色显示
- 保持框线结构一致

## 🎯 颜色方案

| 元素 | 颜色 | 用途 |
|------|------|------|
| 分隔线 | 灰色 | 视觉分隔，不干扰主内容 |
| 框线 | 灰色 | 工具调用的边框 |
| 用户 | 绿色加粗 | 用户输入 |
| AI | 青色加粗 | AI回复 |
| 工具名 | 洋红色 | 工具调用标识 |
| 成功 | 绿色加粗 | 成功状态和标记 |
| 失败 | 红色加粗 | 错误状态和标记 |
| 内容 | 默认色 | 工具返回的内容 |

## 📏 布局规则

### 层次结构
```
对话轮次
├─ 分隔线 (60字符)
├─ 用户输入
│  └─ [U] 你: 输入内容
├─ AI回复
│  └─ [A] AI: 回复内容
└─ 工具调用 (可能有多个)
   ├─ 框线顶部 (缩进2空格, 宽58字符)
   ├─ 工具名称行
   ├─ Spinner动画
   ├─ 状态行 ([✓]完成 / [✗]失败)
   ├─ 结果分隔线
   ├─ 结果内容 (每行前加 │)
   └─ 框线底部
```

### 缩进规则
- 对话主内容：顶格
- 工具调用框：左侧缩进2空格
- 工具结果内容：框内，每行前加 `│ ` (2字符)

## 💡 优势

1. **层次分明**：分隔线清楚地分开每轮对话
2. **视觉聚焦**：工具调用用框线突出，不会混在文字中
3. **状态清晰**：成功/失败用颜色和符号双重标识
4. **易于扫描**：框线结构让工具调用一眼可见
5. **专业美观**：类似现代CLI工具的界面风格

## 🔄 对比

### 旧版本（平铺）
```
[U] 你: 读取文件
[A] AI: 好的
[>] read_file...
[✓] read_file: [文件] 内容...
[U] 你: 搜索代码
[A] AI: 好的
[>] search_code...
```
问题：
- 所有内容混在一起
- 分不清哪些是工具调用
- 难以快速定位信息

### 新版本（结构化）
```
────────────────────────────────────────────────────────────
[U] 你: 读取文件
[A] AI: 好的

  ┌────────────────────────────────────────────────────────┐
  │ 工具调用: read_file                                      │
  │ / 执行中...
[✓] 完成
  │ ────────────────────────────────────────────────────────
  │ [文件] 内容...
  └────────────────────────────────────────────────────────┘

────────────────────────────────────────────────────────────
[U] 你: 搜索代码
```
优势：
- ✅ 每轮对话清晰分隔
- ✅ 工具调用有明显的视觉边界
- ✅ 结果内容在框内，易于阅读
- ✅ 整体结构一目了然

## 🚀 使用体验

运行程序后，你会看到：

1. **启动时**：漂亮的标题和系统环境信息
2. **输入时**：每次都有分隔线，知道新的一轮开始了
3. **工具执行时**：看到框线和旋转的spinner
4. **结果显示时**：清楚地知道是成功还是失败，结果在框内
5. **多个工具时**：每个工具都有自己的框，不会混淆

整体感觉：**清晰、专业、易读**！
