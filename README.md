# J.A.R.V.I.S - è¶…çº§äººå·¥æ™ºèƒ½

Just A Rather Very Intelligent System

åŸºäº DeepSeek API å’Œ Function Calling çš„è¶…çº§äººå·¥æ™ºèƒ½ç³»ç»Ÿã€‚é€šè¿‡å·¥å…·èµ‹èƒ½ï¼ŒJARVIS æ‹¥æœ‰æ–‡ä»¶æ“ä½œã€ä»£ç åˆ†æã€å‘½ä»¤æ‰§è¡Œã€Gitç®¡ç†ç­‰å¤šç§èƒ½åŠ›ã€‚

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
ai_assistant/
â”œâ”€â”€ main.go                    # ä¸»ç¨‹åºå…¥å£ï¼ˆçº¦170è¡Œï¼‰
â”œâ”€â”€ main.go.old               # æ—§ç‰ˆæœ¬å¤‡ä»½ï¼ˆ1807è¡Œï¼‰
â”œâ”€â”€ go.mod                    # Goæ¨¡å—é…ç½®
â”œâ”€â”€ chat_history.json         # å¯¹è¯å†å²
â”‚
â”œâ”€â”€ config/                   # é…ç½®åŒ…
â”‚   â””â”€â”€ config.go            # APIå¯†é’¥ã€æ¨¡å‹é…ç½®
â”‚
â””â”€â”€ internal/                 # å†…éƒ¨åŒ…
    â”œâ”€â”€ process/             # è¿›ç¨‹ç®¡ç†
    â”‚   â””â”€â”€ manager.go       # äº¤äº’å¼è¿›ç¨‹ç®¡ç†å™¨
    â”‚
    â”œâ”€â”€ tools/               # å·¥å…·ç³»ç»Ÿ
    â”‚   â”œâ”€â”€ definitions.go   # å·¥å…·å®šä¹‰ï¼ˆ15ä¸ªå·¥å…·ï¼‰
    â”‚   â”œâ”€â”€ executor.go      # å·¥å…·æ‰§è¡Œè·¯ç”±
    â”‚   â”œâ”€â”€ file.go         # æ–‡ä»¶æ“ä½œå·¥å…·
    â”‚   â”œâ”€â”€ command.go      # å‘½ä»¤æ‰§è¡Œå·¥å…·
    â”‚   â”œâ”€â”€ search.go       # ä»£ç æœç´¢å·¥å…·
    â”‚   â”œâ”€â”€ project.go      # é¡¹ç›®åˆ†æå·¥å…·
    â”‚   â””â”€â”€ git.go          # Gitå·¥å…·
    â”‚
    â”œâ”€â”€ backup/              # å¤‡ä»½æ’¤é”€
    â”‚   â””â”€â”€ backup.go        # æ“ä½œå¤‡ä»½ä¸æ¢å¤
    â”‚
    â”œâ”€â”€ approval/            # æ‰¹å‡†æµç¨‹
    â”‚   â””â”€â”€ approval.go      # ç™½åå•/é»‘åå•æ‰¹å‡†
    â”‚
    â”œâ”€â”€ environment/         # ç¯å¢ƒæ£€æµ‹
    â”‚   â””â”€â”€ detect.go        # ç³»ç»Ÿç¯å¢ƒè‡ªåŠ¨æ£€æµ‹
    â”‚
    â”œâ”€â”€ prompt/              # ç³»ç»Ÿæç¤ºè¯
    â”‚   â””â”€â”€ system.go        # åŠ¨æ€ç”Ÿæˆç³»ç»Ÿæç¤º
    â”‚
    â”œâ”€â”€ history/             # å†å²ç®¡ç†
    â”‚   â””â”€â”€ history.go       # å¯¹è¯å†å²åŠ è½½/ä¿å­˜
    â”‚
    â””â”€â”€ ui/                  # ç•Œé¢ç¾åŒ–ï¼ˆé¢„ç•™ï¼‰
        â”œâ”€â”€ ui.go            # ç»ˆç«¯ç•Œé¢è¾“å‡º
        â””â”€â”€ theme.go         # ä¸»é¢˜é…ç½®ï¼ˆé¢„ç•™ï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¼–è¯‘è¿è¡Œ

```bash
# ç¼–è¯‘
go build -o ai_assistant.exe

# è¿è¡Œ
./ai_assistant.exe
```

### æˆ–ç›´æ¥è¿è¡Œ

```bash
go run main.go
```

## ğŸ› ï¸ å·¥å…·åˆ—è¡¨

### æ–‡ä»¶æ“ä½œï¼ˆ4ä¸ªï¼‰
- `read_file` - è¯»å–æ–‡ä»¶å†…å®¹
- `edit_file` - ç²¾å‡†ç¼–è¾‘ï¼ˆå­—ç¬¦ä¸²æ›¿æ¢ï¼‰
- `rename_symbol` - æ™ºèƒ½é‡å‘½åï¼ˆGoç”¨ASTï¼Œå…¶ä»–ç”¨æ­£åˆ™ï¼‰
- `delete_file` - åˆ é™¤æ–‡ä»¶

### å‘½ä»¤æ‰§è¡Œï¼ˆ4ä¸ªï¼‰
- `run_command` - æ‰§è¡Œå‘½ä»¤ï¼ˆæ”¯æŒäº¤äº’å¼ï¼‰
- `send_input` - å‘è¿›ç¨‹å‘é€è¾“å…¥
- `get_output` - è·å–è¿›ç¨‹è¾“å‡º
- `kill_process` - ç»ˆæ­¢è¿›ç¨‹

### ä»£ç æœç´¢ï¼ˆ2ä¸ªï¼‰
- `search_code` - åœ¨é¡¹ç›®ä¸­æœç´¢ä»£ç 
- `find_symbol` - æŸ¥æ‰¾ç¬¦å·å®šä¹‰

### é¡¹ç›®åˆ†æï¼ˆ3ä¸ªï¼‰
- `list_directory` - åˆ—å‡ºç›®å½•
- `get_project_structure` - è·å–é¡¹ç›®æ ‘
- `get_file_stats` - è·å–æ–‡ä»¶ç»Ÿè®¡

### Gitå·¥å…·ï¼ˆ3ä¸ªï¼‰
- `git_status` - æŸ¥çœ‹çŠ¶æ€
- `git_diff` - æŸ¥çœ‹å·®å¼‚
- `git_commit` - æäº¤æ›´æ”¹

## ğŸ’¡ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½æ‰¹å‡†æœºåˆ¶
- **è‡ªåŠ¨æ‰§è¡Œ**: æŸ¥è¯¢æ“ä½œï¼ˆ`read_file`, `get_output`ç­‰ï¼‰
- **å…ˆæ‰§è¡Œåç¡®è®¤**: ä¿®æ”¹æ“ä½œï¼ˆ`edit_file`, `rename_symbol`, `delete_file`ï¼‰ï¼Œå¯æ’¤é”€
- **æå‰æ‰¹å‡†**: å±é™©æ“ä½œï¼ˆ`run_command`, `git_commit`ç­‰ï¼‰ï¼Œä¸å¯æ’¤é”€

### 2. æ‰¹å‡†æ–¹å¼
```
y       - å…¨éƒ¨åŒæ„
n       - å…¨éƒ¨æ‹’ç»
y 1,2,3 - åªåŒæ„æŒ‡å®šçš„ï¼ˆç™½åå•ï¼‰
n 1,3   - æ‹’ç»æŒ‡å®šçš„ï¼ˆé»‘åå•ï¼‰
```

### 3. ç¯å¢ƒè‡ªé€‚åº”
ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ï¼š
- æ“ä½œç³»ç»Ÿï¼ˆWindows/Linux/macOSï¼‰
- Shellç±»å‹ï¼ˆPowerShell/Bashï¼‰
- Pythonå‘½ä»¤ï¼ˆpython3/python/noneï¼‰
- Gitå¯ç”¨æ€§
- grepå·¥å…·ï¼ˆUnixï¼‰

æ ¹æ®æ£€æµ‹ç»“æœåŠ¨æ€è°ƒæ•´ï¼š
- ç³»ç»Ÿæç¤ºè¯
- å‘½ä»¤å»ºè®®
- å·¥å…·è¡Œä¸º

### 4. ASTæ™ºèƒ½é‡å‘½å
Goæ–‡ä»¶ä½¿ç”¨è¯­æ³•æ ‘ç²¾å‡†é‡å‘½åï¼Œé¿å…å­—ç¬¦ä¸²è¯¯åŒ¹é…

### 5. æ¨¡å—åŒ–è®¾è®¡
- æ¯ä¸ªåŒ…èŒè´£å•ä¸€
- æ˜“äºæµ‹è¯•å’Œç»´æŠ¤
- ä¾¿äºæ·»åŠ æ–°åŠŸèƒ½

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

```
ğŸ‘¤ ä½ : å¸®æˆ‘è¯»å–main.goæ–‡ä»¶
ğŸ¤– AI: [è°ƒç”¨ read_file å·¥å…·...]

ğŸ‘¤ ä½ : æŠŠå‡½æ•°å oldFunc æ”¹æˆ newFunc
ğŸ¤– AI: [è°ƒç”¨ rename_symbol å·¥å…·...]
ğŸ“‹ ä»¥ä¸‹ä¿®æ”¹å·²æ‰§è¡Œï¼Œè¯·ç¡®è®¤ï¼š
1. main.go
è¯·é€‰æ‹©: y
âœ… æ‰€æœ‰ä¿®æ”¹å·²ç¡®è®¤

ğŸ‘¤ ä½ : è¿è¡Œæµ‹è¯•å‘½ä»¤
ğŸ¤– AI: [è°ƒç”¨ run_command å·¥å…·...]
âš ï¸  ä»¥ä¸‹æ“ä½œä¸å¯æ’¤é”€ï¼Œéœ€è¦ç«‹å³æ‰¹å‡†ï¼š
1. run_command({"command": "go test", "interactive": false})
è¯·é€‰æ‹©: y
```

## ğŸ¨ UIç¾åŒ–ï¼ˆå·²å®ç°ï¼‰

`internal/ui/` åŒ…æä¾›ç¾åŒ–çš„ç»ˆç«¯ç•Œé¢ï¼š

### å·²å®ç°åŠŸèƒ½
- âœ… **å½©è‰²è¾“å‡º**ï¼ˆä½¿ç”¨ `fatih/color`ï¼‰
  - æˆåŠŸ/é”™è¯¯/è­¦å‘Š/ä¿¡æ¯ç”¨ä¸åŒé¢œè‰²åŒºåˆ†
  - ç”¨æˆ·/AI/å·¥å…·è¾“å‡ºæœ‰ç‹¬ç‰¹é¢œè‰²
- âœ… **SpinneråŠ è½½åŠ¨ç”»**ï¼ˆä½¿ç”¨ `briandowns/spinner`ï¼‰
  - å·¥å…·æ‰§è¡Œæ—¶æ˜¾ç¤ºæ—‹è½¬åŠ¨ç”»
  - å®Œæˆåæ˜¾ç¤º [âœ“] æˆ– [âœ—] æ ‡è®°
- âœ… **å…¼å®¹æ€§ç¬¦å·**
  - ä¸ä½¿ç”¨emojiï¼Œé¿å…Windows/Linuxä¹±ç 
  - ä½¿ç”¨ `[âœ“]` `[âœ—]` `[i]` ç­‰ASCIIç¬¦å·

### é¢œè‰²æ–¹æ¡ˆ
```
æ ‡é¢˜/AI    -> é’è‰²åŠ ç²—
æˆåŠŸ/ç”¨æˆ·  -> ç»¿è‰²åŠ ç²—
é”™è¯¯       -> çº¢è‰²åŠ ç²—
è­¦å‘Š       -> é»„è‰²åŠ ç²—
ä¿¡æ¯       -> è“è‰²
å·¥å…·       -> æ´‹çº¢è‰²
æ¬¡è¦ä¿¡æ¯   -> ç°è‰²
```

### é¢„ç•™æ‰©å±•
- è¿›åº¦æ¡ï¼ˆä½¿ç”¨ `schollz/progressbar`ï¼‰
- è¡¨æ ¼å±•ç¤ºï¼ˆä½¿ç”¨ `olekukonko/tablewriter`ï¼‰
- Markdownæ¸²æŸ“ï¼ˆä½¿ç”¨ `charmbracelet/glamour`ï¼‰
- äº¤äº’å¼èœå•ï¼ˆä½¿ç”¨ `manifoldco/promptui`ï¼‰

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| `main.go` | ~170 | ä¸»ç¨‹åºï¼ˆç®€åŒ–åï¼‰ |
| `main.go.old` | 1807 | æ—§ç‰ˆæœ¬ï¼ˆå•æ–‡ä»¶ï¼‰ |
| **æ€»æ¨¡å—ä»£ç ** | ~1200 | æ‹†åˆ†åçš„æ‰€æœ‰åŒ… |

## ğŸ”§ å¼€å‘å»ºè®®

### æ·»åŠ æ–°å·¥å…·
1. åœ¨ `internal/tools/definitions.go` æ·»åŠ å·¥å…·å®šä¹‰
2. åœ¨å¯¹åº”çš„å·¥å…·æ–‡ä»¶ä¸­å®ç°æ‰§è¡Œå‡½æ•°
3. åœ¨ `internal/tools/executor.go` æ·»åŠ è·¯ç”±

### ä¿®æ”¹æ‰¹å‡†é€»è¾‘
ç¼–è¾‘ `internal/approval/approval.go`

### è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯
ç¼–è¾‘ `internal/prompt/system.go`

### ç¾åŒ–ç•Œé¢
åœ¨ `internal/ui/` ä¸­å®ç°å½©è‰²è¾“å‡ºã€è¿›åº¦æ¡ç­‰åŠŸèƒ½

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [go-openai](https://github.com/sashabaranov/go-openai) - OpenAI API Goå®¢æˆ·ç«¯
- [DeepSeek](https://www.deepseek.com/) - AIæ¨¡å‹æä¾›å•†
